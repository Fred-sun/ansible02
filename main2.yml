- name: set guid for registration definition id
  set_fact:
     #subscription_id: "{{ azure_subscription_id }}"
     subscription_id: f64d4ee8-be94-457d-ba26-3fa6b6506cef
     reg_def_name: test_name
  run_once: yes
  tags: fred

- name: Create a RegistrationDefinition
  azure_rm_registrationdefinition:
    registration_definition_id: 9b2895ec-fb1e-4a1e-a978-abd9933d6b20
    scope: subscriptions//{{ subscription_id }}
    properties:
      description: first_test
      authorizations:
        - principal_id: 99e3227f-8701-4099-869f-bc3efc7f1e64
          role_definition_id: b24988ac-6180-42a0-ab88-20f7382dd24c
      managed_by_tenant_id: fbcdd0f3-dc82-4cee-bcde-7301d24e9bf6
      registration_definition_name: "{{ reg_def_name }}"

- name: Create a RegistrationDefinition
  azure_rm_registrationdefinition_info:
    #registration_definition_id: 9b2895ec-fb1e-4a1e-a978-abd9933d6b20
    scope: subscriptions//{{ subscription_id }}
  register: output
  tags: fred

- debug:
    var: output
  tags: fred
